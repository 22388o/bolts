{
    "comment": "A test case for concatenating blinded routes.",
    "recipient_route": {
        "comment": "This section contains the portion of the route from an introduction node to the recipient before blinding, and the tlv stream that will be encrypted for each hop.",
        "hops": [
            {
                "node_id": "027f31ebc5462c1fdce1b737ecff52d37d75dea43ce11c74d25aa297165faa2007",
                "tlvs": {
                    "next_node_id": "032c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"
                },
                "encoded_tlvs": "0421032c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"
            },
            {
                "node_id": "032c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",
                "tlvs": {
                    "next_node_id": "02edabbd16b41c8371b92ef2f04c1185b4f03b6dcd52ba9b78d9d7c89c8f221145"
                },
                "encoded_tlvs": "042102edabbd16b41c8371b92ef2f04c1185b4f03b6dcd52ba9b78d9d7c89c8f221145"
            },
            {
                "node_id": "02edabbd16b41c8371b92ef2f04c1185b4f03b6dcd52ba9b78d9d7c89c8f221145",
                "tlvs": {
                    "padding": "000000000000000000000000000000",
                    "path_id": "00112233445566778899aabbccddeeff"
                },
                "encoded_tlvs": "010f000000000000000000000000000000061000112233445566778899aabbccddeeff"
            }    
        ]
    },
    "recipient_route_blinding": {
        "comment": "This section contains the internal values generated by the recipient at each iteration of the blinding process applied to route provided above.",
        "hops": [
            {
                "ephemeral_privkey": "0101010101010101010101010101010101010101010101010101010101010101",
                "ephemeral_pubkey": "031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f",
                "shared_secret": "1073bca66c96d2b25b29735781ec20b13f21c5ce932d2a8bb9cca9a0d767ad09",
                "rho": "e29257b28242dc5992deded03bb3337f7c990bde23aa6f5c89c8ca29cecd184e",
                "encrypted_data": "30015dcdcbce70bdcd0125be8ccd541b101d95bcb049ccfc737f91c98cc139cb6f16354ec5a38e77eca769c2245ac4467524d6",
                "blinded_node_id": "021026e6369e42b7f6d723c0c56a3e0b4d67111f07685bd03e9fa6d93ac6bb6dbe"
            },
            {
                "ephemeral_privkey": "b4a8d9c35e6762bed0d2834e90002088377d4cfcc3d6ad2d2ca57c3833b6c2bb",
                "ephemeral_pubkey": "03932f4ab7605e8c046b5677becd4d61fdfdc8b9d10f1e9c3080ced0d64fd76931",
                "shared_secret": "0533c63bfd409462e45f62d94df109ef5bf77d41fabc56221d273c469066d5f3",
                "rho": "142bca3084db41ed5ae3bbe4dd809a3fa06f604d368ea3893a1cd5926c2a51fd",
                "encrypted_data": "11e49a0e5f4f8a73b30551bd20448abeb297339b6983ab30d4a227a858311656cbf2444aeff66bd4c8f320ce00ce4ddfed7ca3",
                "blinded_node_id": "02ba3db3fe7f1ed28c4d82f28cf358373cbf3241a16aba265b1b6fb26f094c0c7f"
            },
            {
                "ephemeral_privkey": "902fb8c194310473b5e2895c93e8e43a0a09d768e0b12b1bcf1b99190a59af0a",
                "ephemeral_pubkey": "037bceb365470d24f8204c622e1b7959c6beeb774c634640de6c8401079159fc58",
                "shared_secret": "edda63c70d6a37e7542d729f9d89150c83ab45330156e0d8dc76f039605a0b53",
                "rho": "313a5d37cbeb0ad4e24838aeeda85edcc0ae8c49ca796daab9faf29963c64499",
                "encrypted_data": "fe7e62b65ac8e1c2a319ba53a5519b3f8073416971ae3e722ebc008f38999d590d70d40557e44557c0d32b891bd967119c1f78",
                "blinded_node_id": "0379d4ca14cb19e2f7bcb217d36267e3d03b027bc4228923967f5b2e32cbb763c1"
            }
        ]
    },
    "sender_route": {
        "comment": "This section contains the portion of the route from the sender to the introduction node before blinding, and the tlv stream that will be encrypted for each hop.",
        "hops": [
            {
                "node_id": "02eec7245d6b7d2ccb30380bfbe2a3648cd7a942653f5aa340edcea1f283686619",
                "tlvs": {
                    "padding": "000000000000000000000000000000000000000000000000000000000000000000",
                    "next_node_id": "0324653eac434488002cc06bbfb7f10fe18991e35f9fe4302dbea6d2353dc0ab1c"
                },
                "encoded_tlvs": "012100000000000000000000000000000000000000000000000000000000000000000004210324653eac434488002cc06bbfb7f10fe18991e35f9fe4302dbea6d2353dc0ab1c"
            },
            {
                "node_id": "0324653eac434488002cc06bbfb7f10fe18991e35f9fe4302dbea6d2353dc0ab1c",
                "tlvs": {
                    "next_node_id": "027f31ebc5462c1fdce1b737ecff52d37d75dea43ce11c74d25aa297165faa2007",
                    "next_blinding_override": "031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f"
                },
                "encoded_tlvs": "0421027f31ebc5462c1fdce1b737ecff52d37d75dea43ce11c74d25aa297165faa20070821031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f"
            }    
        ]
    },
    "sender_route_blinding": {
        "comment": "This section contains the internal values generated by the sender at each iteration of the blinding process applied to route provided above.",
        "hops": [
            {
                "ephemeral_privkey": "0202020202020202020202020202020202020202020202020202020202020202",
                "ephemeral_pubkey": "024d4b6cd1361032ca9bd2aeb9d900aa4d45d9ead80ac9423374c451a7254d0766",
                "shared_secret": "61ee3954c6e664507f604fee2b2b4914c80f97f5211eb04456145c141963345e",
                "rho": "47c18aa5928190287cce5140a41964a809e6712fdda7d4363bc5f90a1d90a8ef",
                "encrypted_data": "31da0d438752ed0f19ccd970a386ead7155fd187becd4e1770d561dffdb03d3568dac746dde98725f146582cb040207e8b6c070e28d707564a4dd9fb53f9274ad69d09add393b509a2fa42df5055d7c8aeda5881d5aa",
                "blinded_node_id": "0303176d13958a8a59d59517a6223e12cf291ba5f65c8011efcdca0a52c3850abc"
            },
            {
                "ephemeral_privkey": "0f97050d76bd9430c8b26eb375b231b6d9a6382d8f67884297565b41b58d7f76",
                "ephemeral_pubkey": "02be4b436dbc6cfa43d7d5652bc630ffdaf0dac93e6682db7950828506055ad1a7",
                "shared_secret": "198d8957fe7c3c8369ae5ae0ca130e455d00e7dc132c4c2a223f9763a206d146",
                "rho": "00fe89b5b91ebf6ee0e149bb7fca79c7a608f6b0de4c61f9df49bde1aa879920",
                "encrypted_data": "d9dfa92f898dc8e37b73c944aa4205f225337b2edde67623e775c79e2bcf395dc205004aa07fdc65712afa5c2687aff9bb3d5e6af7c89cc94f23f962a27844ce7629773f9413ebcf131dbc35818410df207f29b013b0",
                "blinded_node_id": "03adbdd3c0fb69641e96de2d5ac923ffc0910d3ed4dfe2314609fae61a71df4da2"
            }
        ]
    },
    "unblinding": {
        "comment": "This section contains the internal values generated by intermediate nodes when unblinding their payload. Each intermediate node receives an ephemeral_pubkey which lets it decrypt the encrypted_recipient_data.",
        "hops": [
            {
                "node_privkey": "4141414141414141414141414141414141414141414141414141414141414141",
                "ephemeral_pubkey": "024d4b6cd1361032ca9bd2aeb9d900aa4d45d9ead80ac9423374c451a7254d0766",
                "blinded_privkey": "30ab1269c91c25a569ae67b6bab25d448468af5ec642f21e36e12d15d656eb1b",
                "decrypted_data": "012100000000000000000000000000000000000000000000000000000000000000000004210324653eac434488002cc06bbfb7f10fe18991e35f9fe4302dbea6d2353dc0ab1c",
                "next_ephemeral_pubkey": "02be4b436dbc6cfa43d7d5652bc630ffdaf0dac93e6682db7950828506055ad1a7"
            },
            {
                "node_privkey": "4242424242424242424242424242424242424242424242424242424242424242",
                "ephemeral_pubkey": "02be4b436dbc6cfa43d7d5652bc630ffdaf0dac93e6682db7950828506055ad1a7",
                "blinded_privkey": "18e95ab08bc5c7f90582354d47f4d114900f0cbf5e20e9cdf4a8477d787f0a0b",
                "decrypted_data": "0421027f31ebc5462c1fdce1b737ecff52d37d75dea43ce11c74d25aa297165faa20070821031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f",
                "next_ephemeral_pubkey": "031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f"
            },
            {
                "node_privkey": "4343434343434343434343434343434343434343434343434343434343434343",
                "comment": "Note that the ephemeral key provided to that one is the override obtained from the previous node's encrypted_data field",
                "ephemeral_pubkey": "031b84c5567b126440995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f",
                "blinded_privkey": "a716a0ce13a6d8f1178eb95f529013d01e3dc4544af2b4cc8c6ddb9e4b9a59ed",
                "decrypted_data": "0421032c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991",
                "next_ephemeral_pubkey": "03932f4ab7605e8c046b5677becd4d61fdfdc8b9d10f1e9c3080ced0d64fd76931"
            },
            {
                "node_privkey": "4444444444444444444444444444444444444444444444444444444444444444",
                "ephemeral_pubkey": "03932f4ab7605e8c046b5677becd4d61fdfdc8b9d10f1e9c3080ced0d64fd76931",
                "blinded_privkey": "0ff35bd0de31da50673417505d8c63ceaaddab9dd79d3d6397781c06e0f3cbba",
                "decrypted_data": "042102edabbd16b41c8371b92ef2f04c1185b4f03b6dcd52ba9b78d9d7c89c8f221145",
                "next_ephemeral_pubkey": "037bceb365470d24f8204c622e1b7959c6beeb774c634640de6c8401079159fc58"
            },
            {
                "node_privkey": "4545454545454545454545454545454545454545454545454545454545454545",
                "ephemeral_pubkey": "037bceb365470d24f8204c622e1b7959c6beeb774c634640de6c8401079159fc58",
                "blinded_privkey": "a58d3738215d56e36f3b5bc5fdd59220fa0a3140a548c506c05d751369731b16",
                "decrypted_data": "010f000000000000000000000000000000061000112233445566778899aabbccddeeff"
            }
        ]
    }
}